# Contexto da Feature: Análise de Conformidade

## Visão Geral
Esta feature é o núcleo do SGN, responsável por receber documentos SST, extrair texto e realizar a análise de conformidade contra NRs usando IA.

## Decisões Arquiteturais e Insights (Sessão 21)
- **Refatoração Server/Client**: A página `src/app/page.tsx` foi convertida em Server Component para realizar o fetch inicial das normas de forma eficiente (server-side). A interatividade (upload, progresso, estados de erro) foi isolada no Client Component `AnaliseCliente`.
- **UX do Botão Principal**: O design "flat" azul escuro foi descartado em favor de um gradiente vivo e sombras (`bg-gradient-to-r from-blue-600 to-indigo-600`). Decisão tomada após feedback de que o design flat parecia estar permanentemente desabilitado, prejudicando a clicabilidade percebida.
- **Resiliência de Gradientes**: Títulos com `bg-clip-text` em modo dark devem usar gradientes com pontos intermediários claros (`dark:via-indigo-300`) para garantir legibilidade contra o fundo escuro do CanvasBackground.
- **Legibilidade**: Adicionado `leading-normal` e `pb-2` em títulos grandes para evitar o corte de descendentes (letras como 'g') causado por containers restritivos em versões anteriores.
- **Workspace NotebookLM (Sessão 39)**: Migração para layout de 3 colunas paralelas. O Chat foi trazido para o centro para incentivar a interação contínua com a fonte local. O `ChatSidePanel` foi descartado para evitar redundância e "fricção visual" (muitos cliques para abrir/fechar). A largura do container é dinâmica (`1700px` em 3-col vs `max-w-7xl` em 2-col).
- **Comunicação por Eventos**: Uso de `window.dispatchEvent` para abrir o chat a partir de botões em componentes distantes (como no componente de resultados), mantendo o código desacoplado e sem a necessidade de Context providers pesados.

## Fluxo de Dados
1. `page.tsx` (Server) -> `getNormas()`
2. `AnaliseCliente.tsx` (Client) <- props: `normasIniciais`
3. Upload -> `api/extrair-texto`
4. Análise -> `api/ia/analisar-conformidade`
5. Exibição -> `ResultadoAnalise.tsx`
